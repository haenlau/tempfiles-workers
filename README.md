#  Cloudflare 临时文件存储服务

基于 **Cloudflare Workers + KV** 的轻量级临时文件上传与分享工具。

> 所有文件 **12 小时后自动过期删除**，单文件大小限制为 **25MB**。  
> 完全免费、无需服务器、开箱即用，适合快速分享截图、日志、文档等临时内容。  
> 本项目仅依赖 **Cloudflare 免费套餐功能**，无需高级订阅。

---

##  功能特性

-  **Web 界面上传**任意类型文件（≤25MB）  
-  **自动生成短链接**，一键分享  
-  文件自动设置 **12 小时 TTL**（过期即自动删除）  
-  下载时 **保留原始文件名**，并强制以附件形式下载  
-  **支持 CORS**，可被前端应用直接调用  
-  **路径白名单保护**，避免与未来 API 路由冲突  
-  **无用户系统、无数据库、无外部依赖** —— 极简架构，零运维

---

##  使用场景

- 快速分享屏幕截图或错误日志  
- 临时传输小文档、配置文件或代码片段  
- 前端调试时上传测试文件  
- 无需注册的匿名文件中转站

---

## 第一步：创建 Worker

1. 登录 [Cloudflare 控制台](https://dash.cloudflare.com)。
2. 在左侧导航栏点击 **计算和 AI > Workers 和 Pages**。
3. 点击右上角 **“+ 添加”**，选择 **“从 Hello World! 开始”**。
4. 输入 Worker 名称（例如 `temp-files`），点击 **“部署”**。

部署完成后，你将进入该 Worker 的管理页面。

---

## 第二步：创建并绑定 KV 命名空间

1. 在左侧导航栏点击 **存储和数据库 > Workers KV**。
2. 点击 **“+ 创建命名空间”**，输入名称 `TEMP_STORE`，点击 **“创建”**。
3. 返回到刚创建的命名空间，点击右侧 **“绑定”**。
4. 选择你刚刚创建的 Worker，将变量名设为 `TEMP_STORE`，点击 **“绑定”**。

> 此 KV 用于存储上传的文件内容，必须完成绑定才能正常使用。

---

## 第三步：配置 Secret（可选）

如果你希望启用受保护的 API 上传（需 Token 鉴权），请设置一个密钥：

1. 在 Worker 页面，点击顶部标签 **“变量和机密”**。
2. 在 **“密钥”** 区域点击 **“+ 添加”**。
3. 设置：
   - **名称**：`UPLOAD_TOKEN`
   - **值**：任意强密码（如 `x7GkL9qP2mNvR5`）
4. 点击 **“保存”**。

> 如果不设置此密钥，`/api/upload` 接口将返回错误，但网页上传仍可使用。

---

## 第四步：导入代码

1. 打开你的 GitHub 仓库，找到 `index.js` 文件。
2. 复制全部内容。
3. 回到 Cloudflare Worker 页面，点击右上角 **“编辑代码”**。
4. 清空编辑器中的默认代码，粘贴你从仓库复制的 `index.js` 内容。
5. 点击 **“保存并部署”**。

> 代码中已包含逻辑判断，无需手动修改域名。只要通过正确域名访问（见下一步），生成的下载链接即为有效地址。

---

## 第五步：绑定自定义域名（可选）

如果你拥有自己的域名（如 `tmp.air1.cn`），可以绑定以获得更简洁的访问地址：

1. 在 Worker 页面，点击顶部标签 **“域和路由”**。
2. 点击 **“+ 添加”**，选择 **“自定义域”**。
3. 输入你的子域名（例如 `tmp.air1.cn`）。
4. 按照提示在你的 DNS 提供商处添加指定的 CNAME 或 A 记录。

> 若跳过此步，可直接使用 Cloudflare 分配的 `.workers.dev` 地址访问服务。

---

## 第六步：测试服务

### 网页上传测试

打开浏览器，访问你的 Worker 地址，例如：

https://temp-files.yourname.workers.dev

或你的自定义域名：

https://yourname.domain

选择文件上传，成功后会显示下载链接。

API 上传测试（需 Token）
使用 curl 测试受保护接口：
```bash
curl -X POST https://tmp.air1.cn/api/upload \
-H "Authorization: Bearer your-upload-token" \
-F "file=@example.txt"
```
将 your-upload-token 替换为你在第四步设置的实际值。

完成以上步骤后，临时文件服务即可正式上线使用。如需更新功能，只需重新粘贴最新版 index.js 并重新部署即可。


 项目地址：[https://github.com/haenlau/tempfiles-workers](https://github.com/haenlau/tempfiles-workers)

